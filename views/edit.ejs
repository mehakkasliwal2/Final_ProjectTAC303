<%- include('partials/head', { pageTitle: 'Edit Brand | Sustainable Beauty Brand Directory', metaDescription: 'Edit an existing sustainable beauty brand entry with packaging, certifications, and ingredient evidence.' }) %>

<header class="hero" id="top">
  <%- include('partials/nav', { current: '' }) %>
  <div class="hero-content">
    <div class="hero-text">
      <h1>Edit brand</h1>
      <p class="lead">Update certifications, packaging details, and sourcing notes before republishing to the directory.</p>
      <div class="hero-ctas">
        <a class="button primary" href="#submit-form">Update brand</a>
        <a class="button ghost" href="/browse">Back to browse</a>
      </div>
    </div>
  </div>
</header>

<main id="main">
  <section id="submit-form" class="section">
    <header>
      <h2>Brand details</h2>
      <p>Make edits and save. Removing certifications is supported via the list below.</p>
    </header>
    <form class="submit-form" method="POST" action="/brands/<%= id %>/edit" enctype="multipart/form-data" novalidate>
      <div class="form-grid">
        <label>
          Brand name
          <input type="text" name="name" value="<%= values.name || '' %>" required>
          <% if (errors.name) { %><span class="form-error"><%= errors.name %></span><% } %>
        </label>
        <label>
          Official website
          <input type="url" name="website" value="<%= values.website || '' %>" placeholder="https://">
          <% if (errors.website) { %><span class="form-error"><%= errors.website %></span><% } %>
        </label>
        <label>
          Country of operations
          <input type="text" name="country" value="<%= values.country || '' %>" placeholder="Canada, USA, Korea">
        </label>
      </div>

      <label>
        Certifications (comma separated)
        <input type="text" name="certifications" value="<%= Array.isArray(values.certifications) ? values.certifications.join(', ') : (values.certifications || '') %>" placeholder="Leaping Bunny, Climate Neutral">
      </label>

      <label>
        Packaging details
        <textarea name="packaging" rows="3" placeholder="Materials used, refill or mail-back instructions, recycling notes"><%= values.packaging || '' %></textarea>
      </label>

      <fieldset class="image-fieldset">
        <legend>Brand image</legend>
        <p class="muted">Upload a new file to refresh the visual on the browse cards.</p>
        <label>
          Upload image file
          <input type="file" name="image_file" id="image_file" accept="image/*">
        </label>
      </fieldset>

      <label>
        Ingredient documentation summary
        <textarea name="summary" rows="3" placeholder="INCI list + lab PDF link or screenshots" required><%= values.summary || '' %></textarea>
        <% if (errors.summary) { %><span class="form-error"><%= errors.summary %></span><% } %>
      </label>

      <div class="form-grid">
        <label>
          Price tier
          <select name="price_tier" required>
            <option value="">Select one</option>
            <option value="$" <%= values.price_tier === '$' ? 'selected' : '' %>>$</option>
            <option value="$$" <%= values.price_tier === '$$' ? 'selected' : '' %>>$$</option>
            <option value="$$$" <%= values.price_tier === '$$$' ? 'selected' : '' %>>$$$</option>
          </select>
          <% if (errors.price_tier) { %><span class="form-error"><%= errors.price_tier %></span><% } %>
        </label>
      </div>

      <button type="submit" class="button primary full-width">Save changes</button>
    </form>
  </section>
</main>

<script>
  // Image selection/upload preview for edit page
  (function() {
    const fileInput = document.getElementById('image_file');
    fileInput?.addEventListener('change', () => {});
  })();
</script>

<%- include('partials/footer') %>
